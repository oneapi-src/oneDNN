
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Layer Normalization &#8212; oneDNN v3.3.6 documentation</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/target-highlight.js"></script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"src": "\\operatorname{src}", "srclayer": "\\operatorname{src\\_layer}", "srclayerattention": "\\operatorname{src\\_layer\\_attention}", "srciter": "\\operatorname{src\\_iter}", "srciterc": "\\operatorname{src\\_iter\\_c}", "weights": "\\operatorname{weights}", "weightslayer": "\\operatorname{weights\\_layer}", "weightsiter": "\\operatorname{weights\\_iter}", "weightspeephole": "\\operatorname{weights\\_peephole}", "weightsprojection": "\\operatorname{weights\\_projection}", "bias": "\\operatorname{bias}", "dst": "\\operatorname{dst}", "dstlayer": "\\operatorname{dst\\_layer}", "dstiter": "\\operatorname{dst\\_iter}", "dstiterc": "\\operatorname{dst\\_iter\\_c}", "diffsrc": "\\operatorname{diff\\_src}", "diffsrclayer": "\\operatorname{diff\\_src\\_layer}", "diffsrclayerattention": "\\operatorname{diff\\_src\\_layer\\_attention}", "diffsrciter": "\\operatorname{diff\\_src\\_iter}", "diffsrciterc": "\\operatorname{diff\\_src\\_iter\\_c}", "diffweights": "\\operatorname{diff\\_weights}", "diffweightslayer": "\\operatorname{diff\\_weights\\_layer}", "diffweightsiter": "\\operatorname{diff\\_weights\\_iter}", "diffweightspeephole": "\\operatorname{diff\\_weights\\_peephole}", "diffweightsprojection": "\\operatorname{diff\\_weights\\_projection}", "diffbias": "\\operatorname{diff\\_bias}", "diffdst": "\\operatorname{diff\\_dst}", "diffdstlayer": "\\operatorname{diff\\_dst\\_layer}", "diffdstiter": "\\operatorname{diff\\_dst\\_iter}", "diffdstiterc": "\\operatorname{diff\\_dst\\_iter\\_c}", "diffgamma": "\\operatorname{diff\\_\\gamma}", "diffbeta": "\\operatorname{diff\\_\\beta}", "workspace": "\\operatorname{workspace}", "srcshape": "\\operatorname{src\\_\\shape}", "dstshape": "\\operatorname{dst\\_\\shape}"}}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Local Response Normalization (LRN)" href="dev_guide_lrn.html" />
    <link rel="prev" title="Group Normalization" href="dev_guide_group_normalization.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">oneDNN v3.3.6 documentation</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="build_and_link.html">
   Building and Linking
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_build.html">
     Build from Source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_build_options.html">
     Build Options
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_link.html">
     Linking to the Library
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="programming_model.html">
   Programming Model
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_basic_concepts.html">
     Basic Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="page_getting_started_cpp.html">
     Getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="page_memory_format_propagation_cpp.html">
     Memory Format Propagation
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="dev_guide_inference_and_training_aspects.html">
     Inference and Training Aspects
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_inference.html">
       Inference
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_inference_int8.html">
       Int8 Inference
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_training_bf16.html">
       Bfloat16 Training
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="dev_guide_attributes.html">
     Primitive Attributes
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_attributes_fpmath_mode.html">
       Primitive Attributes: floating-point math mode
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_attributes_quantization.html">
       Primitive Attributes: Quantization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_attributes_post_ops.html">
       Primitive Attributes: Post-ops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_attributes_scratchpad.html">
       Primitive Attributes: Scratchpad
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_data_types.html">
     Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="page_cross_engine_reorder_cpp.html">
     Reorder between CPU and GPU engines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_c_and_cpp_apis.html">
     API
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="interop_with_dpcpp_and_opencl.html">
     Interoperability with DPC++ and OpenCL
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_opencl_interoperability.html">
       OpenCL Interoperability
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_dpcpp_interoperability.html">
       DPC++ Interoperability
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="supported_primitives.html">
   Supported Primitives
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_convolution.html">
     Convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_inner_product.html">
     Inner Product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_matmul.html">
     Matrix Multiplication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_rnn.html">
     RNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_batch_normalization.html">
     Batch Normalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_binary.html">
     Binary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_concat.html">
     Concat
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_eltwise.html">
     Eltwise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_group_normalization.html">
     Group Normalization
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Layer Normalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_lrn.html">
     Local Response Normalization (LRN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_pooling.html">
     Pooling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_prelu.html">
     PReLU
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_resampling.html">
     Resampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_shuffle.html">
     Shuffle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_softmax.html">
     Softmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_sum.html">
     Sum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_reorder.html">
     Reorder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_reduction.html">
     Reduction
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="graph_extension.html">
   Graph Extension
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="graph_programming_model.html">
     Programming Model
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_graph_basic_concepts.html">
       Basic Concepts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_graph_low_precision.html">
       Low Precision
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="graph_supported_operations.html">
     Supported Operations
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_abs.html">
       Abs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_absbackward.html">
       AbsBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_add.html">
       Add
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_avgpool.html">
       AvgPool
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_avgpoolbackward.html">
       AvgPoolBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_batchnormforwardtraining.html">
       BatchNormForwardTraining
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_batchnorminference.html">
       BatchNormInference
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_batchnormtrainingbackward.html">
       BatchNormTrainingBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_biasadd.html">
       BiasAdd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_biasaddbackward.html">
       BiasAddBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_clamp.html">
       Clamp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_clampbackward.html">
       ClampBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_concat.html">
       Concat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_convolution.html">
       Convolution
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_convolutionbackwarddata.html">
       ConvolutionBackwardData
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_convolutionbackwardweights.html">
       ConvolutionBackwardWeights
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_convtranspose.html">
       ConvTranspose
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_convtransposebackwarddata.html">
       ConvTransposeBackwardData
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_convtransposebackwardweights.html">
       ConvTransposeBackwardWeights
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_dequantize.html">
       Dequantize
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_divide.html">
       Divide
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_dynamicdequantize.html">
       DynamicDequantize
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_dynamicquantize.html">
       DynamicQuantize
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_elu.html">
       Elu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_elubackward.html">
       EluBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_end.html">
       End
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_exp.html">
       Exp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_gelu.html">
       GELU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_gelubackward.html">
       GELUBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_hardsigmoid.html">
       HardSigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_hardsigmoidbackward.html">
       HardSigmoidBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_hardswish.html">
       HardSwish
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_hardswishbackward.html">
       HardSwishBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_interpolate.html">
       Interpolate
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_interpolatebackward.html">
       InterpolateBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_layernorm.html">
       LayerNorm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_layernormbackward.html">
       LayerNormBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_leakyrelu.html">
       LeakyReLU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_log.html">
       Log
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_logsoftmax.html">
       LogSoftmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_logsoftmaxbackward.html">
       LogSoftmaxBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_matmul.html">
       MatMul
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_maximum.html">
       Maximum
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_maxpool.html">
       MaxPool
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_maxpoolbackward.html">
       MaxPoolBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_minimum.html">
       Minimum
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_mish.html">
       Mish
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_mishbackward.html">
       MishBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_multiply.html">
       Multiply
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_pow.html">
       Pow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_prelu.html">
       PReLU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_prelubackward.html">
       PReLUBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_quantize.html">
       Quantize
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reciprocal.html">
       Reciprocal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reducel1.html">
       ReduceL1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reducel2.html">
       ReduceL2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reducemax.html">
       ReduceMax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reducemean.html">
       ReduceMean
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reducemin.html">
       ReduceMin
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reduceprod.html">
       ReduceProd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reducesum.html">
       ReduceSum
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_relu.html">
       ReLU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_relubackward.html">
       ReLUBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_reorder.html">
       Reorder
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_round.html">
       Round
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_select.html">
       Select
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_sigmoid.html">
       Sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_sigmoidbackward.html">
       SigmoidBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_softmax.html">
       SoftMax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_softmaxbackward.html">
       SoftMaxBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_softplus.html">
       SoftPlus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_softplusbackward.html">
       SoftPlusBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_sqrt.html">
       Sqrt
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_sqrtbackward.html">
       SqrtBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_square.html">
       Square
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_squareddifference.html">
       SquaredDifference
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_staticreshape.html">
       StaticReshape
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_statictranspose.html">
       StaticTranspose
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_subtract.html">
       Subtract
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_tanh.html">
       Tanh
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_tanhbackward.html">
       TanhBackward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_typecast.html">
       TypeCast
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dev_guide_op_wildcard.html">
       Wildcard
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_graph_fusion_patterns.html">
     Supported Fusion Patterns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_graph_dump.html">
     Graph Dump
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_graph_compiler.html">
     Graph Compiler
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dev_guide_examples.html">
   Examples
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="performance_profiling_and_inspection.html">
   Performance Profiling and Inspection
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_verbose.html">
     Verbose Mode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_performance_settings.html">
     Configuring oneDNN for Benchmarking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_benchdnn.html">
     Benchmarking Performance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_profilers.html">
     Profiling oneDNN Performance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_inspecting_jit.html">
     Inspecting JIT Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="page_performance_profiling_cpp.html">
     Performance Profiling Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_cpu_dispatcher_control.html">
     CPU Dispatcher Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_cpu_isa_hints.html">
     CPU ISA Hints
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="advanced_topics.html">
   Advanced Topics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_transition_to_dnnl.html">
     Transitioning from Intel MKL-DNN to oneDNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_understanding_memory_formats.html">
     Understanding Memory Formats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_int8_computations.html">
     Nuances of int8 Computations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_primitive_cache.html">
     Primitive Cache
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_persistent_cache.html">
     Persistent Cache
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_threadpool.html">
     Using oneDNN with Threadpool-Based Threading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_guide_experimental.html">
     Experimental features
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="group_dnnl_api.html">
   oneDNN API
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_api_primitives.html">
     Primitives
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_primitives_common.html">
       Common
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_alg_kind_t.html">
         enum dnnl_alg_kind_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_normalization_flags_t.html">
         enum dnnl_normalization_flags_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_primitive_kind_t.html">
         enum dnnl_primitive_kind_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_prop_kind_t.html">
         enum dnnl_prop_kind_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_query_t.html">
         enum dnnl_query_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_normalization_flags.html">
         enum dnnl::normalization_flags
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_query.html">
         enum dnnl::query
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_exec_arg_t.html">
         struct dnnl_exec_arg_t
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_primitive.html">
         struct dnnl_primitive
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_primitive_desc.html">
         struct dnnl_primitive_desc
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_primitive-2.html">
         struct dnnl::primitive
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_primitive_kind.html">
           enum dnnl::primitive::kind
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_primitive_desc-2.html">
         struct dnnl::primitive_desc
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_primitive_desc_base.html">
         struct dnnl::primitive_desc_base
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_attributes.html">
       Attributes
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_algorithm.html">
         enum dnnl::algorithm
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_scratchpad_mode_t.html">
         enum dnnl_scratchpad_mode_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_prop_kind.html">
         enum dnnl::prop_kind
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_scratchpad_mode.html">
         enum dnnl::scratchpad_mode
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_post_ops.html">
         struct dnnl_post_ops
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_primitive_attr.html">
         struct dnnl_primitive_attr
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_post_ops-2.html">
         struct dnnl::post_ops
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_primitive_attr-2.html">
         struct dnnl::primitive_attr
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_reorder.html">
       Reorder
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_reorder.html">
         struct dnnl::reorder
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_reorder_primitive_desc.html">
           struct dnnl::reorder::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_concat.html">
       Concat
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_concat.html">
         struct dnnl::concat
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_concat_primitive_desc.html">
           struct dnnl::concat::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_sum.html">
       Sum
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_sum.html">
         struct dnnl::sum
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_sum_primitive_desc.html">
           struct dnnl::sum::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_binary.html">
       Binary
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_binary.html">
         struct dnnl::binary
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_binary_primitive_desc.html">
           struct dnnl::binary::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_convolution.html">
       Convolution
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_convolution_backward_data.html">
         struct dnnl::convolution_backward_data
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_convolution_backward_data_primitive_desc.html">
           struct dnnl::convolution_backward_data::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_convolution_backward_weights.html">
         struct dnnl::convolution_backward_weights
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_convolution_backward_weights_primitive_desc.html">
           struct dnnl::convolution_backward_weights::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_convolution_forward.html">
         struct dnnl::convolution_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_convolution_forward_primitive_desc.html">
           struct dnnl::convolution_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_deconvolution.html">
       Deconvolution
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_deconvolution_backward_data.html">
         struct dnnl::deconvolution_backward_data
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_deconvolution_backward_data_primitive_desc.html">
           struct dnnl::deconvolution_backward_data::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_deconvolution_backward_weights.html">
         struct dnnl::deconvolution_backward_weights
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_deconvolution_backward_weights_primitive_desc.html">
           struct dnnl::deconvolution_backward_weights::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_deconvolution_forward.html">
         struct dnnl::deconvolution_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_deconvolution_forward_primitive_desc.html">
           struct dnnl::deconvolution_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_shuffle.html">
       Shuffle
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_shuffle_backward.html">
         struct dnnl::shuffle_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_shuffle_backward_primitive_desc.html">
           struct dnnl::shuffle_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_shuffle_forward.html">
         struct dnnl::shuffle_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_shuffle_forward_primitive_desc.html">
           struct dnnl::shuffle_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_eltwise.html">
       Eltwise
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_eltwise_backward.html">
         struct dnnl::eltwise_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_eltwise_backward_primitive_desc.html">
           struct dnnl::eltwise_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_eltwise_forward.html">
         struct dnnl::eltwise_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_eltwise_forward_primitive_desc.html">
           struct dnnl::eltwise_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_softmax.html">
       Softmax
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_softmax_backward.html">
         struct dnnl::softmax_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_softmax_backward_primitive_desc.html">
           struct dnnl::softmax_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_softmax_forward.html">
         struct dnnl::softmax_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_softmax_forward_primitive_desc.html">
           struct dnnl::softmax_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_pooling.html">
       Pooling
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_pooling_backward.html">
         struct dnnl::pooling_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_pooling_backward_primitive_desc.html">
           struct dnnl::pooling_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_pooling_forward.html">
         struct dnnl::pooling_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_pooling_forward_primitive_desc.html">
           struct dnnl::pooling_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_prelu.html">
       PReLU
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_prelu_backward.html">
         struct dnnl::prelu_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_prelu_backward_primitive_desc.html">
           struct dnnl::prelu_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_prelu_forward.html">
         struct dnnl::prelu_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_prelu_forward_primitive_desc.html">
           struct dnnl::prelu_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_lrn.html">
       LRN
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lrn_backward.html">
         struct dnnl::lrn_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lrn_backward_primitive_desc.html">
           struct dnnl::lrn_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lrn_forward.html">
         struct dnnl::lrn_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lrn_forward_primitive_desc.html">
           struct dnnl::lrn_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_batch_normalization.html">
       Batch Normalization
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_batch_normalization_backward.html">
         struct dnnl::batch_normalization_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_batch_normalization_backward_primitive_desc.html">
           struct dnnl::batch_normalization_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_batch_normalization_forward.html">
         struct dnnl::batch_normalization_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_batch_normalization_forward_primitive_desc.html">
           struct dnnl::batch_normalization_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_group_normalization.html">
       Group Normalization
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_group_normalization_backward.html">
         struct dnnl::group_normalization_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_group_normalization_backward_primitive_desc.html">
           struct dnnl::group_normalization_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_group_normalization_forward.html">
         struct dnnl::group_normalization_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_group_normalization_forward_primitive_desc.html">
           struct dnnl::group_normalization_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_layer_normalization.html">
       Layer Normalization
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_layer_normalization_backward.html">
         struct dnnl::layer_normalization_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_layer_normalization_backward_primitive_desc.html">
           struct dnnl::layer_normalization_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_layer_normalization_forward.html">
         struct dnnl::layer_normalization_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_layer_normalization_forward_primitive_desc.html">
           struct dnnl::layer_normalization_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_inner_product.html">
       Inner Product
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_inner_product_backward_data.html">
         struct dnnl::inner_product_backward_data
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_inner_product_backward_data_primitive_desc.html">
           struct dnnl::inner_product_backward_data::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_inner_product_backward_weights.html">
         struct dnnl::inner_product_backward_weights
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_inner_product_backward_weights_primitive_desc.html">
           struct dnnl::inner_product_backward_weights::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_inner_product_forward.html">
         struct dnnl::inner_product_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_inner_product_forward_primitive_desc.html">
           struct dnnl::inner_product_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_rnn.html">
       RNN
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_rnn_direction_t.html">
         enum dnnl_rnn_direction_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_rnn_flags_t.html">
         enum dnnl_rnn_flags_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_rnn_direction.html">
         enum dnnl::rnn_direction
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_rnn_flags.html">
         enum dnnl::rnn_flags
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_augru_backward.html">
         struct dnnl::augru_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_augru_backward_primitive_desc.html">
           struct dnnl::augru_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_augru_forward.html">
         struct dnnl::augru_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_augru_forward_primitive_desc.html">
           struct dnnl::augru_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_gru_backward.html">
         struct dnnl::gru_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_gru_backward_primitive_desc.html">
           struct dnnl::gru_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_gru_forward.html">
         struct dnnl::gru_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_gru_forward_primitive_desc.html">
           struct dnnl::gru_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lbr_augru_backward.html">
         struct dnnl::lbr_augru_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lbr_augru_backward_primitive_desc.html">
           struct dnnl::lbr_augru_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lbr_augru_forward.html">
         struct dnnl::lbr_augru_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lbr_augru_forward_primitive_desc.html">
           struct dnnl::lbr_augru_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lbr_gru_backward.html">
         struct dnnl::lbr_gru_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lbr_gru_backward_primitive_desc.html">
           struct dnnl::lbr_gru_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lbr_gru_forward.html">
         struct dnnl::lbr_gru_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lbr_gru_forward_primitive_desc.html">
           struct dnnl::lbr_gru_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lstm_backward.html">
         struct dnnl::lstm_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lstm_backward_primitive_desc.html">
           struct dnnl::lstm_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_lstm_forward.html">
         struct dnnl::lstm_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_lstm_forward_primitive_desc.html">
           struct dnnl::lstm_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_rnn_primitive_desc_base.html">
         struct dnnl::rnn_primitive_desc_base
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_vanilla_rnn_backward.html">
         struct dnnl::vanilla_rnn_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_vanilla_rnn_backward_primitive_desc.html">
           struct dnnl::vanilla_rnn_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_vanilla_rnn_forward.html">
         struct dnnl::vanilla_rnn_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_vanilla_rnn_forward_primitive_desc.html">
           struct dnnl::vanilla_rnn_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_matmul.html">
       Matrix Multiplication
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_matmul.html">
         struct dnnl::matmul
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_matmul_primitive_desc.html">
           struct dnnl::matmul::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_resampling.html">
       Resampling
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_resampling_backward.html">
         struct dnnl::resampling_backward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_resampling_backward_primitive_desc.html">
           struct dnnl::resampling_backward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_resampling_forward.html">
         struct dnnl::resampling_forward
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_resampling_forward_primitive_desc.html">
           struct dnnl::resampling_forward::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_reduction.html">
       Reduction
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_reduction.html">
         struct dnnl::reduction
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_reduction_primitive_desc.html">
           struct dnnl::reduction::primitive_desc
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_api_memory.html">
     Memory
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="enum_dnnl_format_kind_t.html">
       enum dnnl_format_kind_t
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="enum_dnnl_format_tag_t.html">
       enum dnnl_format_tag_t
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="enum_dnnl_profiling_data_kind_t.html">
       enum dnnl_profiling_data_kind_t
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="enum_dnnl_sparse_encoding_t.html">
       enum dnnl_sparse_encoding_t
      </a>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="struct_dnnl_memory.html">
       struct dnnl_memory
      </a>
      <ul class="simple collapse-ul">
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="struct_dnnl_memory_desc.html">
       struct dnnl_memory_desc
      </a>
      <ul class="simple collapse-ul">
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="struct_dnnl_memory-2.html">
       struct dnnl::memory
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_memory_data_type.html">
         enum dnnl::memory::data_type
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_memory_format_kind.html">
         enum dnnl::memory::format_kind
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_memory_format_tag.html">
         enum dnnl::memory::format_tag
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_memory_sparse_encoding.html">
         enum dnnl::memory::sparse_encoding
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_memory_desc-2.html">
         struct dnnl::memory::desc
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_api_primitive_cache.html">
     Primitive Cache
    </a>
    <ul class="simple collapse-ul">
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_api_profiling.html">
     Profiling
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="enum_dnnl_profiling_data_kind.html">
       enum dnnl::profiling_data_kind
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_api_blas.html">
     BLAS functions
    </a>
    <ul class="simple collapse-ul">
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_api_common.html">
     Common API
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_engine.html">
       Engine
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_engine_kind_t.html">
         enum dnnl_engine_kind_t
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_engine.html">
         struct dnnl_engine
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_engine-2.html">
         struct dnnl::engine
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_engine_kind.html">
           enum dnnl::engine::kind
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_stream.html">
       Stream
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_stream_flags_t.html">
         enum dnnl_stream_flags_t
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_stream.html">
         struct dnnl_stream
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_stream-2.html">
         struct dnnl::stream
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_stream_flags.html">
           enum dnnl::stream::flags
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_fpmath_mode.html">
       Floating-point Math Mode
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_fpmath_mode_t.html">
         enum dnnl_fpmath_mode_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_fpmath_mode.html">
         enum dnnl::fpmath_mode
        </a>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_service.html">
       Service
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_cpu_isa.html">
         enum dnnl::cpu_isa
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_cpu_isa_hints.html">
         enum dnnl::cpu_isa_hints
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_cpu_isa_hints_t.html">
         enum dnnl_cpu_isa_hints_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_cpu_isa_t.html">
         enum dnnl_cpu_isa_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_status.html">
         enum dnnl::status
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_version_t.html">
         struct dnnl_version_t
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_utils.html">
       Utilities
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_status_t.html">
         enum dnnl_status_t
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_error.html">
         struct dnnl::error
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_handle.html">
         template struct dnnl::handle
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_handle_traits.html">
         template struct dnnl::handle_traits
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_data_types.html">
       Data types
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_data_type_t.html">
         enum dnnl_data_type_t
        </a>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_graph_api.html">
     Graph API
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_allocator.html">
       Allocator
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="class_dnnl_graph_allocator.html">
         class dnnl::graph::allocator
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_engine.html">
       Engine
      </a>
      <ul class="simple collapse-ul">
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_logical_tensor.html">
       Logical Tensor
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_graph_layout_type_t.html">
         enum dnnl_graph_layout_type_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_graph_tensor_property_t.html">
         enum dnnl_graph_tensor_property_t
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_graph_logical_tensor_t.html">
         struct dnnl_graph_logical_tensor_t
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="class_dnnl_graph_logical_tensor.html">
         class dnnl::graph::logical_tensor
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_graph_logical_tensor_data_type.html">
           enum dnnl::graph::logical_tensor::data_type
          </a>
         </li>
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_graph_logical_tensor_layout_type.html">
           enum dnnl::graph::logical_tensor::layout_type
          </a>
         </li>
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_graph_logical_tensor_property_type.html">
           enum dnnl::graph::logical_tensor::property_type
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_tensor.html">
       Tensor
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="class_dnnl_graph_tensor.html">
         class dnnl::graph::tensor
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_op.html">
       Op
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_graph_op_attr_t.html">
         enum dnnl_graph_op_attr_t
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_graph_op_kind_t.html">
         enum dnnl_graph_op_kind_t
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="class_dnnl_graph_op.html">
         class dnnl::graph::op
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_graph_op_attr.html">
           enum dnnl::graph::op::attr
          </a>
         </li>
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_graph_op_kind.html">
           enum dnnl::graph::op::kind
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_partition.html">
       Partition
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_graph_partition_policy_t.html">
         enum dnnl_graph_partition_policy_t
        </a>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="class_dnnl_graph_partition.html">
         class dnnl::graph::partition
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_graph_partition_policy.html">
           enum dnnl::graph::partition::policy
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_compiled_partition.html">
       Compiled Partition
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="struct_dnnl_graph_inplace_pair_t.html">
         struct dnnl_graph_inplace_pair_t
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="class_dnnl_graph_compiled_partition.html">
         class dnnl::graph::compiled_partition
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_graph.html">
       Graph
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="class_dnnl_graph_graph.html">
         class dnnl::graph::graph
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_compiled_partition_cache.html">
       Compiled Partition Cache
      </a>
      <ul class="simple collapse-ul">
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_constant_tensor_cache.html">
       Constant Tensor Cache
      </a>
      <ul class="simple collapse-ul">
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_graph_api_interop.html">
       Runtime interoperability API
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="group_dnnl_graph_api_sycl_interop.html">
         SYCL interoperability API
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="namespace_dnnl_graph_sycl_interop.html">
           namespace dnnl::graph::sycl_interop
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="namespace_dnnl.html">
       namespace dnnl
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="namespace_dnnl_graph.html">
         namespace dnnl::graph
        </a>
        <ul class="simple collapse-ul">
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="group_dnnl_api_interop.html">
     Runtime interoperability API
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_ocl_interop.html">
       OpenCL interoperability API
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="namespace_dnnl_ocl_interop.html">
         namespace dnnl::ocl_interop
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_ocl_interop_memory_kind.html">
           enum dnnl::ocl_interop::memory_kind
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_ocl_interop_memory_kind_t.html">
         enum dnnl_ocl_interop_memory_kind_t
        </a>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_sycl_interop.html">
       SYCL interoperability API
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="namespace_dnnl_sycl_interop.html">
         namespace dnnl::sycl_interop
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5">
          <a class="reference internal" href="enum_dnnl_sycl_interop_memory_kind.html">
           enum dnnl::sycl_interop::memory_kind
          </a>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="enum_dnnl_sycl_interop_memory_kind_t.html">
         enum dnnl_sycl_interop_memory_kind_t
        </a>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="group_dnnl_api_threadpool_interop.html">
       Threadpool interoperability API
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4 collapsible-parent">
        <a class="reference internal" href="namespace_dnnl_threadpool_interop.html">
         namespace dnnl::threadpool_interop
        </a>
        <ul class="collapse-ul">
         <li class="toctree-l5 collapsible-parent">
          <a class="reference internal" href="struct_dnnl_threadpool_interop_threadpool_iface.html">
           struct dnnl::threadpool_interop::threadpool_iface
          </a>
          <ul class="simple collapse-ul">
          </ul>
          <i class="fas fa-chevron-down">
          </i>
         </li>
        </ul>
        <i class="fas fa-chevron-down">
        </i>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="namespace_oneapi.html">
     namespace oneapi
    </a>
    <ul class="simple collapse-ul">
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/oneapi-src/oneDNN"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general">
   General
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward">
     Forward
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#difference-between-forward-training-and-forward-inference">
       Difference Between Forward Training and Forward Inference
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#backward">
     Backward
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#execution-arguments">
   Execution Arguments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation-details">
   Implementation Details
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-notes">
     General Notes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#post-ops-and-attributes">
     Post-ops and Attributes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-type-support">
     Data Type Support
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-representation">
     Data Representation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mean-and-variance">
       Mean and Variance
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scale-and-shift">
       Scale and Shift
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#source-destination-and-their-gradients">
       Source, Destination, and Their Gradients
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation-limitations">
   Implementation Limitations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#performance-tips">
   Performance Tips
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   Example
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="layer-normalization">
<span id="doxid-dev-guide-layer-normalization"></span><span id="index-0"></span><h1>Layer Normalization<a class="headerlink" href="#layer-normalization" title="Permalink to this headline"></a></h1>
<p><a class="reference internal" href="group_dnnl_api_layer_normalization.html#doxid-group-dnnl-api-layer-normalization"><span class="std std-ref">API Reference</span></a></p>
<section id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline"></a></h2>
<p>The layer normalization primitive performs a forward or backward layer normalization operation on a 2-5D data tensor.</p>
<section id="forward">
<h3>Forward<a class="headerlink" href="#forward" title="Permalink to this headline"></a></h3>
<p>The layer normalization operation performs normalization over the last logical axis of the data tensor and is defined by the following formulas. We show formulas only for 3D data, which are straightforward to generalize to cases of higher dimensions. Variable names follow the standard <a class="reference internal" href="dev_guide_conventions.html#doxid-dev-guide-conventions"><span class="std std-ref">Naming Conventions</span></a>.</p>
<div class="math notranslate nohighlight">
\[\dst(t, n, c) = \gamma(c) \cdot \frac{\src(t, n, c) - \mu(t, n)} {\sqrt{\sigma^2(t, n) + \varepsilon}} + \beta(c),\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\gamma(c), \beta(c)\)</span> are optional scale and shift for a channel (see <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3a01bf8edab9d40fd6a1f8827ee485dc65"><span class="std std-ref">dnnl_use_scale</span></a>, <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3afeb8455811d27d7835503a3740679df0"><span class="std std-ref">dnnl_use_shift</span></a> flags),</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu(t, n), \sigma^2(t, n)\)</span> are mean and variance (see <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3aec04425c28af752c0f8b4dc5ae11fb19"><span class="std std-ref">dnnl_use_global_stats</span></a> flag), and</p></li>
<li><p><span class="math notranslate nohighlight">\(\varepsilon\)</span> is a constant to improve numerical stability.</p></li>
</ul>
<p>Mean and variance are computed at runtime or provided by a user. When mean and variance are computed at runtime, the following formulas are used:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu(t, n) = \frac{1}{C} \sum\limits_{c} \src(t, n, c)_{}\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma^2(t, n) = \frac{1}{C} \sum\limits_{c} {}_{} (\src(t, n, c) - \mu(t, n))^2\)</span>.</p></li>
</ul>
<p>The <span class="math notranslate nohighlight">\(\gamma(c)\)</span> and <span class="math notranslate nohighlight">\(\beta(c)\)</span> tensors are considered learnable.</p>
<section id="difference-between-forward-training-and-forward-inference">
<h4>Difference Between Forward Training and Forward Inference<a class="headerlink" href="#difference-between-forward-training-and-forward-inference" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p>If mean and variance are computed at runtime (i.e., <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3aec04425c28af752c0f8b4dc5ae11fb19"><span class="std std-ref">dnnl_use_global_stats</span></a> is not set), they become outputs for the propagation kind <a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a992e03bebfe623ac876b3636333bbce0"><span class="std std-ref">dnnl_forward_training</span></a> (because they would be required during the backward propagation). Data layout for mean and variance must be specified during creation of the layer normalization primitive descriptor by passing the memory descriptor for statistics (e.g., by passing stat_desc in <a class="reference internal" href="struct_dnnl_layer_normalization_forward_primitive_desc.html#doxid-structdnnl-1-1layer-normalization-forward-1-1primitive-desc"><span class="std std-ref">dnnl::layer_normalization_forward::primitive_desc()</span></a>). Mean and variance are not exposed for the propagation kind <a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a2f77a568a675dec649eb0450c997856d"><span class="std std-ref">dnnl_forward_inference</span></a>.</p></li>
</ul>
</section>
</section>
<section id="backward">
<h3>Backward<a class="headerlink" href="#backward" title="Permalink to this headline"></a></h3>
<p>The backward propagation computes <span class="math notranslate nohighlight">\(\diffsrc(t, n, c)\)</span>, <span class="math notranslate nohighlight">\(\diffgamma(c)^*\)</span>, and <span class="math notranslate nohighlight">\(\diffbeta(c)^*\)</span> based on <span class="math notranslate nohighlight">\(\diffdst(t, n, c)\)</span>, <span class="math notranslate nohighlight">\(src(t, n, c)\)</span>, <span class="math notranslate nohighlight">\(\mu(t, n)\)</span>, <span class="math notranslate nohighlight">\(\sigma^2(t, n)\)</span>, <span class="math notranslate nohighlight">\(\gamma(c) ^*\)</span>, and <span class="math notranslate nohighlight">\(\beta(c) ^*\)</span>.</p>
<p>The tensors marked with an asterisk are used only when the primitive is configured to use <span class="math notranslate nohighlight">\(\gamma(c)\)</span>, and <span class="math notranslate nohighlight">\(\beta(c)\)</span> (i.e., <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3a01bf8edab9d40fd6a1f8827ee485dc65"><span class="std std-ref">dnnl_use_scale</span></a> or <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3afeb8455811d27d7835503a3740679df0"><span class="std std-ref">dnnl_use_shift</span></a> are set).</p>
</section>
</section>
<section id="execution-arguments">
<h2>Execution Arguments<a class="headerlink" href="#execution-arguments" title="Permalink to this headline"></a></h2>
<p>Depending on the <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1ga301f673522a400c7c1e75f518431c9a3"><span class="std std-ref">flags</span></a> and <a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1gae3c1f22ae55645782923fbfd8b07d0c4"><span class="std std-ref">propagation kind</span></a>, the layer normalization primitive requires different inputs and outputs. For clarity, a summary is shown below.</p>
<table class="table">
<colgroup>
<col style="width: 41%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 17%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Flags</p></th>
<th class="head"><p><a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a2f77a568a675dec649eb0450c997856d"><span class="std std-ref">dnnl_forward_inference</span></a></p></th>
<th class="head"><p><a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a992e03bebfe623ac876b3636333bbce0"><span class="std std-ref">dnnl_forward_training</span></a></p></th>
<th class="head"><p><a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a326a5e31769302972e7bded555e1cc10"><span class="std std-ref">dnnl_backward</span></a></p></th>
<th class="head"><p><a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a524dd6cb2ed9680bbd170ba15261d218"><span class="std std-ref">dnnl_backward_data</span></a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3ab71f2077a94fd4bbc107a09b115a24a4"><span class="std std-ref">dnnl_normalization_flags_none</span></a></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\diffdst\)</span> , <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\diffsrc\)</span></p></td>
<td><p>Same as for <a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a326a5e31769302972e7bded555e1cc10"><span class="std std-ref">dnnl_backward</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3aec04425c28af752c0f8b4dc5ae11fb19"><span class="std std-ref">dnnl_use_global_stats</span></a></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\diffdst\)</span> , <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\diffsrc\)</span></p></td>
<td><p>Same as for <a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a326a5e31769302972e7bded555e1cc10"><span class="std std-ref">dnnl_backward</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3a01bf8edab9d40fd6a1f8827ee485dc65"><span class="std std-ref">dnnl_use_scale</span></a></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\gamma\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\gamma\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\diffdst\)</span> , <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> , <span class="math notranslate nohighlight">\(\gamma\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\diffsrc\)</span> , <span class="math notranslate nohighlight">\(\diffgamma\)</span></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3afeb8455811d27d7835503a3740679df0"><span class="std std-ref">dnnl_use_shift</span></a></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\beta\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\beta\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\diffdst\)</span> , <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> , <span class="math notranslate nohighlight">\(\beta\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\diffsrc\)</span> , <span class="math notranslate nohighlight">\(\diffbeta\)</span></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3aec04425c28af752c0f8b4dc5ae11fb19"><span class="std std-ref">dnnl_use_global_stats</span></a> | <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3a01bf8edab9d40fd6a1f8827ee485dc65"><span class="std std-ref">dnnl_use_scale</span></a> | <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3afeb8455811d27d7835503a3740679df0"><span class="std std-ref">dnnl_use_shift</span></a></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> , <span class="math notranslate nohighlight">\(\gamma\)</span> , <span class="math notranslate nohighlight">\(\beta\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> , <span class="math notranslate nohighlight">\(\gamma\)</span> , <span class="math notranslate nohighlight">\(\beta\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><em>Inputs</em> : <span class="math notranslate nohighlight">\(\diffdst\)</span> , <span class="math notranslate nohighlight">\(\src\)</span> , <span class="math notranslate nohighlight">\(\mu\)</span> , <span class="math notranslate nohighlight">\(\sigma^2\)</span> , <span class="math notranslate nohighlight">\(\gamma\)</span> , <span class="math notranslate nohighlight">\(\beta\)</span> <em>Outputs</em> : <span class="math notranslate nohighlight">\(\diffsrc\)</span> , <span class="math notranslate nohighlight">\(\diffgamma\)</span> , <span class="math notranslate nohighlight">\(\diffbeta\)</span></p></td>
<td><p>Not supported</p></td>
</tr>
</tbody>
</table>
<p>When executed, the inputs and outputs should be mapped to an execution argument index as specified by the following table.</p>
<table class="table">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Primitive input/output</p></th>
<th class="head"><p>Execution argument index</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\src\)</span></p></td>
<td><p>DNNL_ARG_SRC</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma\)</span></p></td>
<td><p>DNNL_ARG_SCALE</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p>DNNL_ARG_SHIFT</p></td>
</tr>
<tr class="row-odd"><td><p>mean ( <span class="math notranslate nohighlight">\(\mu\)</span> )</p></td>
<td><p>DNNL_ARG_MEAN</p></td>
</tr>
<tr class="row-even"><td><p>variance ( <span class="math notranslate nohighlight">\(\sigma\)</span> )</p></td>
<td><p>DNNL_ARG_VARIANCE</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p>DNNL_ARG_DST</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\diffdst\)</span></p></td>
<td><p>DNNL_ARG_DIFF_DST</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\diffsrc\)</span></p></td>
<td><p>DNNL_ARG_DIFF_SRC</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\diffgamma\)</span></p></td>
<td><p>DNNL_ARG_DIFF_SCALE</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\diffbeta\)</span></p></td>
<td><p>DNNL_ARG_DIFF_SHIFT</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(src scale\)</span></p></td>
<td><p>DNNL_ARG_ATTR_SCALES | DNNL_ARG_SRC</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(dst scale\)</span></p></td>
<td><p>DNNL_ARG_ATTR_SCALES | DNNL_ARG_DST</p></td>
</tr>
</tbody>
</table>
</section>
<section id="implementation-details">
<h2>Implementation Details<a class="headerlink" href="#implementation-details" title="Permalink to this headline"></a></h2>
<section id="general-notes">
<h3>General Notes<a class="headerlink" href="#general-notes" title="Permalink to this headline"></a></h3>
<ol class="arabic simple">
<li><p>The different flavors of the primitive are partially controlled by the <code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter that is passed to the primitive descriptor creation function (e.g., <a class="reference internal" href="struct_dnnl_layer_normalization_forward_primitive_desc.html#doxid-structdnnl-1-1layer-normalization-forward-1-1primitive-desc"><span class="std std-ref">dnnl::layer_normalization_forward::primitive_desc()</span></a>). Multiple flags can be set using the bitwise OR operator (<code class="docutils literal notranslate"><span class="pre">|</span></code>).</p></li>
<li><p>For forward propagation, the mean and variance might be either computed at runtime (in which case they are outputs of the primitive) or provided by a user (in which case they are inputs). In the latter case, a user must set the <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3aec04425c28af752c0f8b4dc5ae11fb19"><span class="std std-ref">dnnl_use_global_stats</span></a> flag. For the backward propagation, the mean and variance are always input parameters.</p></li>
<li><p>Both forward and backward propagation support in-place operations, meaning that <span class="math notranslate nohighlight">\(\src\)</span> can be used as input and output for forward propagation, and <span class="math notranslate nohighlight">\(\diffdst\)</span> can be used as input and output for backward propagation. In case of an in-place operation, the original data will be overwritten. This support is limited to cases when data types of <span class="math notranslate nohighlight">\(\src\)</span> and <span class="math notranslate nohighlight">\(\dst\)</span> or <span class="math notranslate nohighlight">\(\diffsrc\)</span> and <span class="math notranslate nohighlight">\(\diffdst\)</span> are identical. Note, however, that backward propagation requires original <span class="math notranslate nohighlight">\(\src\)</span>, hence the corresponding forward propagation should not be performed in-place.</p></li>
</ol>
</section>
<section id="post-ops-and-attributes">
<h3>Post-ops and Attributes<a class="headerlink" href="#post-ops-and-attributes" title="Permalink to this headline"></a></h3>
<p>Attributes enable you to modify the behavior of the layer normalization primitive. The following attributes are supported by the layer normalization primitive:</p>
<table class="table">
<colgroup>
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 34%" />
<col style="width: 24%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Propagation</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Operation</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Restrictions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>forward</p></td>
<td><p>attribute</p></td>
<td><p><a class="reference internal" href="struct_dnnl_primitive_attr-2.html#doxid-structdnnl-1-1primitive-attr-1ac3dc9efa6702a5eba6f289f1b3907590"><span class="std std-ref">Scales</span></a></p></td>
<td><p>Scales the corresponding tensor by the given scale factor(s).</p></td>
<td><p>Supported only for int8 layer normalization and one scale per tensor is supported.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="data-type-support">
<h3>Data Type Support<a class="headerlink" href="#data-type-support" title="Permalink to this headline"></a></h3>
<p>The operation supports the following combinations of data types:</p>
<table class="table">
<colgroup>
<col style="width: 18%" />
<col style="width: 41%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Propagation</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Destination</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>forward</p></td>
<td><p>f32, bf16, f16, u8, s8, f64</p></td>
<td><p>f32, bf16, f16, u8, s8, f64</p></td>
</tr>
<tr class="row-odd"><td><p>backward</p></td>
<td><p>f32, bf16, f16, f64</p></td>
<td><p>f32, bf16, f16, f64</p></td>
</tr>
</tbody>
</table>
<p>Mean, Variance and ScaleShift data types are always f32 and independent of Source or Destination data types.</p>
</section>
<section id="data-representation">
<h3>Data Representation<a class="headerlink" href="#data-representation" title="Permalink to this headline"></a></h3>
<section id="mean-and-variance">
<h4>Mean and Variance<a class="headerlink" href="#mean-and-variance" title="Permalink to this headline"></a></h4>
<p>The mean (<span class="math notranslate nohighlight">\(\mu\)</span>) and variance (<span class="math notranslate nohighlight">\(\sigma^2\)</span>) are separate tensors with number of dimensions equal to (<span class="math notranslate nohighlight">\(data\_ndims - 1\)</span>) and size <span class="math notranslate nohighlight">\((data\_dim[0], data\_dim[1], ..., data\_dim[ndims - 2])\)</span>.</p>
<p>The corresponding memory object can have an arbitrary memory format. Unless mean and variance are computed at runtime and not exposed (i.e., propagation kind is <a class="reference internal" href="enum_dnnl_prop_kind_t.html#doxid-group-dnnl-api-primitives-common-1ggae3c1f22ae55645782923fbfd8b07d0c4a2f77a568a675dec649eb0450c997856d"><span class="std std-ref">dnnl_forward_inference</span></a> and <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3aec04425c28af752c0f8b4dc5ae11fb19"><span class="std std-ref">dnnl_use_global_stats</span></a> is not set), the user should provide a memory descriptor for statistics when creating the layer normalization primitive descriptor. For best performance, it is advised to use the memory format that follows the data memory format; i.e., if the data format is <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da2a9735ec024c9362b717304edbfe2237"><span class="std std-ref">dnnl_tnc</span></a>, the best performance can be expected for statistics with the <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091dac1ee747f881fc8cae805ae4051e671cf"><span class="std std-ref">dnnl_tn</span></a> format and suboptimal for statistics with the <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da7ede27a46172c1ab2775593ba4b118dc"><span class="std std-ref">dnnl_nt</span></a> format.</p>
</section>
<section id="scale-and-shift">
<h4>Scale and Shift<a class="headerlink" href="#scale-and-shift" title="Permalink to this headline"></a></h4>
<p>If <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3a01bf8edab9d40fd6a1f8827ee485dc65"><span class="std std-ref">dnnl_use_scale</span></a> or <a class="reference internal" href="enum_dnnl_normalization_flags_t.html#doxid-group-dnnl-api-primitives-common-1gga301f673522a400c7c1e75f518431c9a3afeb8455811d27d7835503a3740679df0"><span class="std std-ref">dnnl_use_shift</span></a> are used, the scale (<span class="math notranslate nohighlight">\(\gamma\)</span>) and shift (<span class="math notranslate nohighlight">\(\beta\)</span>) are separate 1D tensors of shape <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>The format of the corresponding memory object must be <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091dac08a541001fe70289305a5fbde48906d"><span class="std std-ref">dnnl_nc</span></a> (<a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da1bd907fc29344dfe7ba88336960dcf53"><span class="std std-ref">dnnl_ab</span></a>).</p>
</section>
<section id="source-destination-and-their-gradients">
<h4>Source, Destination, and Their Gradients<a class="headerlink" href="#source-destination-and-their-gradients" title="Permalink to this headline"></a></h4>
<p>The layer normalization primitive works with an arbitrary data tensor; however, it was designed for RNN data tensors (i.e., <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091dac08a541001fe70289305a5fbde48906d"><span class="std std-ref">dnnl_nc</span></a>, <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da2a9735ec024c9362b717304edbfe2237"><span class="std std-ref">dnnl_tnc</span></a>, <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da4fd1cf9fdb67c554bcd8281695b65b3c"><span class="std std-ref">dnnl_ldnc</span></a>). Unlike CNN data tensors, RNN data tensors have a single feature dimension. Layer normalization performs normalization over the last logical dimension (feature dimension for RNN tensors) across non-feature dimensions.</p>
<p>The layer normalization primitive is optimized for the following memory formats:</p>
<table class="table">
<colgroup>
<col style="width: 3%" />
<col style="width: 97%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Logical tensor</p></th>
<th class="head"><p>Implementations optimized for memory formats</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NC</p></td>
<td><p><a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091dac08a541001fe70289305a5fbde48906d"><span class="std std-ref">dnnl_nc</span></a> ( <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da1bd907fc29344dfe7ba88336960dcf53"><span class="std std-ref">dnnl_ab</span></a> )</p></td>
</tr>
<tr class="row-odd"><td><p>TNC</p></td>
<td><p><a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da2a9735ec024c9362b717304edbfe2237"><span class="std std-ref">dnnl_tnc</span></a> ( <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091dadff5ea69392d7e4da23179dc0ba7cbc2"><span class="std std-ref">dnnl_abc</span></a> ), <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da5d73ca7a68559ef44241be5a096e6bff"><span class="std std-ref">dnnl_ntc</span></a> ( <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091dae31cc3d3a0bfbd4936f7b503cf6dc9de"><span class="std std-ref">dnnl_bac</span></a> )</p></td>
</tr>
<tr class="row-even"><td><p>LDNC</p></td>
<td><p><a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da4fd1cf9fdb67c554bcd8281695b65b3c"><span class="std std-ref">dnnl_ldnc</span></a> ( <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da6e669cc61278663a5ddbd3d0b25c6c5c"><span class="std std-ref">dnnl_abcd</span></a> )</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="implementation-limitations">
<h2>Implementation Limitations<a class="headerlink" href="#implementation-limitations" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p>Refer to <a class="reference internal" href="dev_guide_data_types.html#doxid-dev-guide-data-types"><span class="std std-ref">Data Types</span></a> for limitations related to data types support.</p></li>
<li><p>GPU</p>
<ul class="simple">
<li><p>Only tensors of 6 or fewer dimensions are supported.</p></li>
<li><p>Different data types for source and destination is not supported.</p></li>
<li><p>Integer data types for source and destination are not supported.</p></li>
</ul>
</li>
</ol>
</section>
<section id="performance-tips">
<h2>Performance Tips<a class="headerlink" href="#performance-tips" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p>For data tensors <span class="math notranslate nohighlight">\(\src\)</span>, <span class="math notranslate nohighlight">\(\dst\)</span>, <span class="math notranslate nohighlight">\(\diffsrc\)</span>, and <span class="math notranslate nohighlight">\(\diffdst\)</span>, use memory formats for which the last logical axis is the last in the physical memory layout.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">variance</span></code>, use the memory format that follows the data memory format; i.e., if the data format is <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da2a9735ec024c9362b717304edbfe2237"><span class="std std-ref">dnnl_tnc</span></a>, the best performance can be expected for statistics with <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091dac1ee747f881fc8cae805ae4051e671cf"><span class="std std-ref">dnnl_tn</span></a> and suboptimal for statistics with the <a class="reference internal" href="enum_dnnl_format_tag_t.html#doxid-group-dnnl-api-memory-1gga395e42b594683adb25ed2d842bb3091da7ede27a46172c1ab2775593ba4b118dc"><span class="std std-ref">dnnl_nt</span></a> format.</p></li>
<li><p>For backward propagation, use the same memory format for <span class="math notranslate nohighlight">\(\src\)</span>, <span class="math notranslate nohighlight">\(\diffdst\)</span>, and <span class="math notranslate nohighlight">\(\diffsrc\)</span>. Different formats are functionally supported but lead to highly suboptimal performance.</p></li>
<li><p>Use in-place operations whenever possible (see caveats in General Notes).</p></li>
</ol>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<p><a class="reference internal" href="page_layer_normalization_example_cpp.html#doxid-layer-normalization-example-cpp"><span class="std std-ref">Layer Normalization Primitive Example</span></a></p>
<p>This C++ API example demonstrates how to create and execute a <a class="reference internal" href="#doxid-dev-guide-layer-normalization"><span class="std std-ref">Layer normalization</span></a> primitive in forward propagation mode.</p>
<p>Key optimizations included in this example:</p>
<ul class="simple">
<li><p>In-place primitive execution;</p></li>
<li><p>Creation of memory objects using the primitive descriptor.</p></li>
</ul>
</section>
</section>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="dev_guide_group_normalization.html" title="previous page">Group Normalization</a>
    <a class='right-next' id="next-link" href="dev_guide_lrn.html" title="next page">Local Response Normalization (LRN)</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2016-2022 Intel Corporation.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>